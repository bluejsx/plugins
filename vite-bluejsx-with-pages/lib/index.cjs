var $=Object.create;var u=Object.defineProperty;var b=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var C=Object.getPrototypeOf,j=Object.prototype.hasOwnProperty;var y=e=>u(e,"__esModule",{value:!0});var k=(e,t)=>{for(var r in t)u(e,r,{get:t[r],enumerable:!0})},h=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of x(t))!j.call(e,s)&&(r||s!=="default")&&u(e,s,{get:()=>t[s],enumerable:!(o=b(t,s))||o.enumerable});return e},c=(e,t)=>h(y(u(e!=null?$(C(e)):{},"default",!t&&e&&e.__esModule?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e),F=(e=>(t,r)=>e&&e.get(t)||(r=h(y({}),t,1),e&&e.set(t,r),r))(typeof WeakMap!="undefined"?new WeakMap:0);var U={};k(U,{default:()=>D});var S=c(require("directory-tree"),1),i=c(require("path"),1),w=c(require("vite"),1),P=c(require("vite-with-bluejsx"),1),n=c(require("fs"),1),v=c(require("deepmerge"),1);function D(e){var f;(0,P.default)(e);let t={},r=J(),o=(0,i.resolve)(r,"./pages"),s=(0,i.resolve)(r,"./.bluepages");try{(0,n.statSync)(s),n.default.rmSync(s,{recursive:!0})}catch{n.default.mkdirSync(s,{recursive:!0})}let B=(0,S.default)(o,{extensions:/\.(md|mdx|js|jsx|ts|tsx)$/,normalizePath:!0},({name:p},l)=>{let a=p.replace(/.[\w]+$/,"");if(a.indexOf("_")===0)return null;let d=(0,i.relative)(r+"/pages",l),m=(0,i.resolve)(s+"/"+d,"../");n.default.mkdirSync(m,{recursive:!0});let g=(0,i.resolve)(m,`./${a}.html`);n.default.writeFileSync((0,i.resolve)(m,`./${a}.js`),`import Component from '${(0,i.relative)(m,l)}';import('${(0,i.relative)(m,o)}/_app').then(({default: Page})=>document.querySelector('#app').appendChild(Page({Component,pageProps:{}})))`);let _=n.default.readFileSync(`${o}/_template.html`,"utf-8").replace("</body",`<script type="module" src="./${a}.js"><\/script></body`);n.default.writeFileSync(g,_),t[d.replace(/\//,"_").replace(/.[\w]+$/,"")]=g});return(f=e.plugins)!=null||(e.plugins=[]),e.plugins.push({name:"with-pages-listen-dir",async configureServer(p){let{watcher:l}=p;l.add(o),l.on("add",(a,d)=>{a.includes(o)&&O(p)})}}),(0,v.default)(e,{build:{rollupOptions:{input:t},emptyOutDir:!0,outDir:(0,i.relative)(s,(0,i.resolve)(r,"./dist"))},root:s,publicDir:r+"/public"})}function J(){for(let e of module.paths)try{let t=(0,i.dirname)(e);return(0,n.accessSync)(e,n.constants.F_OK),t}catch{}}async function O(e){global.__vite_start_time=Date.now();let{port:t}=e.config.server;await e.close();let r=null;try{r=await(0,w.createServer)(e.config.inlineConfig)}catch(o){e.config.logger.error(o.message,{timestamp:!0});return}for(let o in r)o!=="app"&&(e[o]=r[o]);e.config.server.middlewareMode?e.config.logger.info("server restarted.",{timestamp:!0}):await e.listen(t,!0)}module.exports=F(U);0&&(module.exports={});
